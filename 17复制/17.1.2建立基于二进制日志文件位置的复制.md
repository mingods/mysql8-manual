-   [17.1.2.1 Setting the Replication Source Configuration](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterbaseconfig.html)

    17.1.2.1 设置复制源配置

-   [17.1.2.2 Setting the Replica Configuration](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slavebaseconfig.html)

    17.1.2.2 设置复制配置

-   [17.1.2.3 Creating a User for Replication](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-repuser.html)

    17.1.2.3 为复制创建用户

-   [17.1.2.4 Obtaining the Replication Source Binary Log Coordinates](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html)

    17.1.2.4 获取复制源二进制日志的坐标

-   [17.1.2.5 Choosing a Method for Data Snapshots](https://dev.mysql.com/doc/refman/8.0/en/replication-snapshot-method.html)

    17.1.2.5 选择数据快照的方法

-   [17.1.2.6 Setting Up Replicas](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html)

    17.1.2.6 设置副本

-   [17.1.2.7 Setting the Source Configuration on the Replica](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slaveinit.html)

    17.1.2.7 在副本上设置源配置

-   [17.1.2.8 Adding Replicas to a Replication Environment](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-additionalslaves.html)

    17.1.2.8 向复制环境中添加副本

This section describes how to set up a MySQL server to use binary log file position based replication. There are a number of different methods for setting up replication, and the exact method to use depends on how you are setting up replication, and whether you already have data in the database on the source that you want to replicate.

本节介绍如何设置 MySQL 服务器使用基于二进制日志文件位置的复制。设置复制有许多不同的方法，具体使用哪种方法取决于如何设置复制，以及数据库中是否已经有要复制的源的数据。

>   To deploy multiple instances of MySQL, you can use [InnoDB Cluster](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-innodb-cluster.html) which enables you to easily administer a group of MySQL server instances in [MySQL Shell](https://dev.mysql.com/doc/mysql-shell/8.0/en/). InnoDB Cluster wraps MySQL Group Replication in a programmatic environment that enables you easily deploy a cluster of MySQL instances to achieve high availability. In addition, InnoDB Cluster interfaces seamlessly with [MySQL Router](https://dev.mysql.com/doc/mysql-router/8.0/en/), which enables your applications to connect to the cluster without writing your own failover process. For similar use cases that do not require high availability, however, you can use [InnoDB ReplicaSet](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-innodb-replicaset.html). Installation instructions for MySQL Shell can be found [here](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-install.html).
>
>   要部署多个MySQL实例，你可以使用[InnoDB Cluster](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-innodb-cluster.html)，它可以让你在[MySQL Shell](https://dev.mysql.com/doc/mysql-shell/8.0/en/)中轻松管理一组MySQL服务器实例。InnoDB Cluster将MySQL Group Replication封装在一个编程环境中，使您能够轻松部署MySQL实例集群以实现高可用性。此外，InnoDB集群与[MySQL路由器](https://dev.mysql.com/doc/mysql-router/8.0/en/)无缝连接，这使你的应用程序无需编写自己的故障转移过程就可以连接到集群。对于不需要高可用性的类似用例，您可以使用[InnoDB replicset](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-innodb-replicaset.html)。MySQL Shell的安装说明可以在这里找到(https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-install.html)。

There are some generic tasks that are common to all setups:

有一些通用的任务在所有的设置中都是通用的:

-   On the source, you must ensure that binary logging is enabled, and configure a unique server ID. This might require a server restart. See [Section 17.1.2.1, “Setting the Replication Source Configuration”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterbaseconfig.html).

    在源上，必须确保启用二进制日志记录，并配置唯一的服务器ID。这可能需要重新启动服务器。

-   On each replica that you want to connect to the source, you must configure a unique server ID. This might require a server restart. See [Section 17.1.2.2, “Setting the Replica Configuration”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slavebaseconfig.html).

    在希望连接到源的每个副本上，必须配置惟一的服务器ID。这可能需要重新启动服务器。

-   Optionally, create a separate user for your replicas to use during authentication with the source when reading the binary log for replication. See [Section 17.1.2.3, “Creating a User for Replication”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-repuser.html).

    还可以为副本创建一个单独的用户，以便在读取二进制日志进行复制时对源进行身份验证时使用。

-   Before creating a data snapshot or starting the replication process, on the source you should record the current position in the binary log. You need this information when configuring the replica so that the replica knows where within the binary log to start executing events. See [Section 17.1.2.4, “Obtaining the Replication Source Binary Log Coordinates”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html).

    在创建数据快照或启动复制过程之前，应该在源上将当前位置记录在二进制日志中。在配置副本时需要这些信息，以便副本知道在二进制日志中的何处开始执行事件。

-   If you already have data on the source and want to use it to synchronize the replica, you need to create a data snapshot to copy the data to the replica. The storage engine you are using has an impact on how you create the snapshot. When you are using [`MyISAM`](https://dev.mysql.com/doc/refman/8.0/en/myisam-storage-engine.html), you must stop processing statements on the source to obtain a read-lock, then obtain its current binary log coordinates and dump its data, before permitting the source to continue executing statements. If you do not stop the execution of statements, the data dump and the source status information become mismatched, resulting in inconsistent or corrupted databases on the replicas. For more information on replicating a [`MyISAM`](https://dev.mysql.com/doc/refman/8.0/en/myisam-storage-engine.html) source, see [Section 17.1.2.4, “Obtaining the Replication Source Binary Log Coordinates”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html). If you are using [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html), you do not need a read-lock and a transaction that is long enough to transfer the data snapshot is sufficient. For more information, see [Section 15.19, “InnoDB and MySQL Replication”](https://dev.mysql.com/doc/refman/8.0/en/innodb-and-mysql-replication.html).

    如果源上已经有数据，并且希望使用它来同步副本，则需要创建一个数据快照来将数据复制到副本。使用的存储引擎会影响创建快照的方式。当使用[' MyISAM '](https://dev.mysql.com/doc/refman/8.0/en/myisam-storage-engine.html)时，必须停止处理源上的语句以获得读锁，然后获取其当前二进制日志坐标并转储其数据，然后才允许源继续执行语句。如果不停止语句的执行，则数据转储和源状态信息将不匹配，从而导致副本上的数据库不一致或损坏。

-   Configure the replica with settings for connecting to the source, such as the host name, login credentials, and binary log file name and position. See [Section 17.1.2.7, “Setting the Source Configuration on the Replica”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slaveinit.html).

    使用连接到源的设置配置副本，例如主机名、登录凭据和二进制日志文件名和位置。

-   Implement replication-specific security measures on the sources and replicas as appropriate for your system. See [Section 17.3, “Replication Security”](https://dev.mysql.com/doc/refman/8.0/en/replication-security.html).

    根据系统的需要，在源和副本上实现特定于复制的安全措施。

>   Note
>
>   Certain steps within the setup process require the [`SUPER`](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_super) privilege. If you do not have this privilege, it might not be possible to enable replication.
>
>   安装过程中的某些步骤需要[' SUPER '](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_super)权限。如果您没有此特权，则可能无法启用复制。

After configuring the basic options, select your scenario:

配置完基本选项后，选择您的场景:

-   To set up replication for a fresh installation of a source and replicas that contain no data, see [Section 17.1.2.6.1, “Setting Up Replication with New Source and Replicas”](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html#replication-howto-newservers).

    要为新安装的源和不包含数据的副本设置复制，

-   To set up replication of a new source using the data from an existing MySQL server, see [Section 17.1.2.6.2, “Setting Up Replication with Existing Data”](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html#replication-howto-existingdata).

    要使用来自现有MySQL服务器的数据建立新源的复制，

-   To add replicas to an existing replication environment, see [Section 17.1.2.8, “Adding Replicas to a Replication Environment”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-additionalslaves.html).

    若要向现有复制环境添加副本，

Before administering MySQL replication servers, read this entire chapter and try all statements mentioned in [Section 13.4.1, “SQL Statements for Controlling Source Servers”](https://dev.mysql.com/doc/refman/8.0/en/replication-statements-master.html), and [Section 13.4.2, “SQL Statements for Controlling Replica Servers”](https://dev.mysql.com/doc/refman/8.0/en/replication-statements-replica.html). Also familiarize yourself with the replication startup options described in [Section 17.1.6, “Replication and Binary Logging Options and Variables”](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html).



## 17.1.2.1 Setting the Replication Source Configuration

To configure a source to use binary log file position based replication, you must ensure that binary logging is enabled, and establish a unique server ID.

要将源配置为使用基于二进制日志文件位置的复制，必须确保启用了二进制日志记录，并建立唯一的服务器ID。

Each server within a replication topology must be configured with a unique server ID, which you can specify using the [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) system variable. This server ID is used to identify individual servers within the replication topology, and must be a positive integer between 1 and (2^32^)−1. The default [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) value from MySQL 8.0 is 1. You can change the [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) value dynamically by issuing a statement like this:

复制拓扑中的每个服务器都必须配置唯一的服务器ID，您可以使用[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)系统变量指定该服务器ID。该服务器ID用于标识复制拓扑中的各个服务器，必须为1到(2^32^)−1之间的正整数。MySQL 8.0的默认值[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)是1。您可以通过发出如下语句动态更改[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)值:

```sql
SET GLOBAL server_id = 2;
```

How you organize and select the server IDs is your choice, so long as each server ID is different from every other server ID in use by any other server in the replication topology. Note that if a value of 0 (which was the default in earlier releases) was set previously for the server ID, you must restart the server to initialize the source with your new nonzero server ID. Otherwise, a server restart is not needed when you change the server ID, unless you make other configuration changes that require it.

如何组织和选择服务器ID是您的选择，只要每个服务器ID不同于复制拓扑中任何其他服务器使用的其他服务器ID。注意，如果之前为服务器ID设置了0值(这是早期版本中的默认值)，则必须重新启动服务器，以使用新的非零服务器ID初始化源。否则，在更改服务器ID时不需要重新启动服务器，除非您进行了其他需要重新启动服务器的配置更改。

Binary logging is required on the source because the binary log is the basis for replicating changes from the source to its replicas. Binary logging is enabled by default (the [`log_bin`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_bin) system variable is set to ON). The [`--log-bin`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#option_mysqld_log-bin) option tells the server what base name to use for binary log files. It is recommended that you specify this option to give the binary log files a non-default base name, so that if the host name changes, you can easily continue to use the same binary log file names (see [Section B.3.7, “Known Issues in MySQL”](https://dev.mysql.com/doc/refman/8.0/en/known-issues.html)). If binary logging was previously disabled on the source using the [`--skip-log-bin`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#option_mysqld_log-bin) option, you must restart the server without this option to enable it.

源上需要二进制日志记录，因为二进制日志是将更改从源复制到其副本的基础。默认情况下启用二进制日志记录([' log_bin '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_bin)系统变量设置为ON)。['——log-bin '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#option_mysqld_log-bin)选项告诉服务器为二进制日志文件使用什么基名。建议您指定这个选项来为二进制日志文件提供一个非默认的基本名称，这样，如果主机名发生变化，您可以轻松地继续使用相同的二进制日志文件名(参见[B.3.7节，“MySQL的已知问题”](https://dev.mysql.com/doc/refman/8.0/en/known-issues.html))。如果以前在源上使用['——skip-log-bin '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#option_mysqld_log-bin)选项禁用了二进制日志记录，则必须在没有此选项的情况下重新启动服务器才能启用它。



>   Note
>
>   The following options also have an impact on the source:
>
>   -   For the greatest possible durability and consistency in a replication setup using [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html) with transactions, you should use `innodb_flush_log_at_trx_commit=1` and `sync_binlog=1` in the source's `my.cnf` file.
>
>       为了在使用[' InnoDB '](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html)的事务复制设置中获得最大的持久性和一致性，你应该在源的' my.cnf '文件中使用' innodb_flush_log_at_trx_commit=1 '和' sync_binlog=1 '。
>
>   -   Ensure that the [`skip_networking`](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_skip_networking) system variable is not enabled on the source. If networking has been disabled, the replica cannot communicate with the source and replication fails.
>
>       确保源上没有启用[' skip_networking '](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_skip_networking)系统变量。如果已禁用网络，则副本无法与源端通信，复制失败。



## 17.1.2.2 Setting the Replica Configuration

Each replica must have a unique server ID, as specified by the [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) system variable. If you are setting up multiple replicas, each one must have a unique [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) value that differs from that of the source and from any of the other replicas. If the replica's server ID is not already set, or the current value conflicts with the value that you have chosen for the source or another replica, you must change it.

每个副本必须有一个唯一的服务器ID，由[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)系统变量指定。如果您正在设置多个副本，每个副本必须具有唯一的[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)值，该值不同于源副本的值和任何其他副本的值。如果副本的服务器ID尚未设置，或者当前值与为源副本或其他副本选择的值冲突，则必须更改它。

The default [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) value is 1. You can change the [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) value dynamically by issuing a statement like this:

默认值[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)为1。您可以通过发出如下语句动态更改[' server_id '](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id)值:

```sql
SET GLOBAL server_id = 21;
```

Note that a value of 0 for the server ID prevents a replica from connecting to a source. If that server ID value (which was the default in earlier releases) was set previously, you must restart the server to initialize the replica with your new nonzero server ID. Otherwise, a server restart is not needed when you change the server ID, unless you make other configuration changes that require it. For example, if binary logging was disabled on the server and you want it enabled for your replica, a server restart is required to enable this.

注意，如果服务器ID值为0，将阻止副本连接到源。如果之前设置了该服务器ID值(这是早期版本中的默认值)，则必须重新启动服务器，以使用新的非零服务器ID初始化副本。否则，在更改服务器ID时不需要重新启动服务器，除非您进行了其他需要重新启动服务器的配置更改。例如，如果在服务器上禁用了二进制日志记录，而您希望为您的副本启用它，则需要重新启动服务器来启用它。

If you are shutting down the replica server, you can edit the `[mysqld]` section of the configuration file to specify a unique server ID. For example:

如果您正在关闭复制服务器，您可以编辑配置文件的' [mysqld] '部分，以指定唯一的服务器ID。例如:

```ini
[mysqld]
server-id=21
```

Binary logging is enabled by default on all servers. A replica is not required to have binary logging enabled for replication to take place. However, binary logging on a replica means that the replica's binary log can be used for data backups and crash recovery. Replicas that have binary logging enabled can also be used as part of a more complex replication topology. For example, you might want to set up replication servers using this chained arrangement:

在所有服务器上默认启用二进制日志记录。复制不需要启用二进制日志记录才能进行复制。但是，副本上的二进制日志记录意味着副本的二进制日志可用于数据备份和崩溃恢复。启用了二进制日志记录的副本也可以作为更复杂的复制拓扑的一部分使用。例如，你可能想要使用这种链式安排来设置复制服务器:

```none
A -> B -> C
```

Here, `A` serves as the source for the replica `B`, and `B` serves as the source for the replica `C`. For this to work, `B` must be both a source *and* a replica. Updates received from `A` must be logged by `B` to its binary log, in order to be passed on to `C`. In addition to binary logging, this replication topology requires the system variable [`log_replica_updates`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_replica_updates) (from MySQL 8.0.26) or [`log_slave_updates`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_slave_updates) (before MySQL 8.0.26) to be enabled. With replica updates enabled, the replica writes updates that are received from a source and performed by the replica's SQL thread to the replica's own binary log. The [`log_replica_updates`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_replica_updates) or [`log_slave_updates`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_slave_updates) system variable is enabled by default.

在这里，' A '作为副本' B '的源，' B '作为副本' C '的源。要做到这一点，' B '必须既是源又是副本。从' A '接收到的更新必须由' B '记录到它的二进制日志中，以便传递给' C '。除了二进制日志记录之外，这个复制拓扑还需要启用系统变量[' log_replica_updates '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_replica_updates)(来自MySQL 8.0.26)或[' log_slave_updates '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_slave_updates)(在MySQL 8.0.26之前)。启用了副本更新后，副本将从源接收并由副本的SQL线程执行的更新写入副本自己的二进制日志。默认情况下，[' log_replica_updates '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_replica_updates)或[' log_slave_updates '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_slave_updates)系统变量是启用的。

If you need to disable binary logging or replica update logging on a replica, you can do this by specifying the [`--skip-log-bin`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#option_mysqld_log-bin) and [`--log-replica-updates=OFF`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_replica_updates) or [`--log-slave-updates=OFF`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_slave_updates) options for the replica. If you decide to re-enable these features on the replica, remove the relevant options and restart the server.

如果需要禁用副本上的二进制日志记录或副本更新日志记录，您可以通过为副本指定['——skip-log-bin '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#option_mysqld_log-bin)和['——log-replica-updates=OFF '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_replica_updates)或['——log-slave-updates=OFF '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_log_slave_updates)选项来实现这一点。如果您决定在副本上重新启用这些功能，请删除相关选项并重新启动服务器。



## 17.1.2.3 Creating a User for Replication

Each replica connects to the source using a MySQL user name and password, so there must be a user account on the source that the replica can use to connect. The user name is specified by the `SOURCE_USER` | `MASTER_USER` option of the [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) statement (from MySQL 8.0.23) or [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement (before MySQL 8.0.23) when you set up a replica. Any account can be used for this operation, providing it has been granted the [`REPLICATION SLAVE`](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave) privilege. You can choose to create a different account for each replica, or connect to the source using the same account for each replica.

每个副本使用MySQL用户名和密码连接到源，因此源上必须有一个用户帐户，副本可以使用该帐户进行连接。当你建立一个副本时，用户名由[' CHANGE REPLICATION SOURCE TO '](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)语句(从MySQL 8.0.23)或[' CHANGE MASTER TO '](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html)语句(在MySQL 8.0.23之前)中的' SOURCE_USER ' | ' MASTER_USER '选项指定。任何帐户都可以用于此操作，只要它被授予[' REPLICATION SLAVE '](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave)权限。您可以选择为每个副本创建不同的帐户，或者为每个副本使用相同的帐户连接到源。

Although you do not have to create an account specifically for replication, you should be aware that the replication user name and password are stored in plain text in the replica's connection metadata repository `mysql.slave_master_info` (see [Section 17.2.4.2, “Replication Metadata Repositories”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs-status.html)). Therefore, you may want to create a separate account that has privileges only for the replication process, to minimize the possibility of compromise to other accounts.

尽管您不必专门为复制创建帐户，但您应该知道复制用户名和密码以纯文本的形式存储在副本的连接元数据存储库' mysql.slave_master_info '(参见[第17.2.4.2节，“复制元数据存储库”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs-status.html))。因此，您可能希望创建一个单独的帐户，该帐户只对复制过程具有特权，以尽量减少对其他帐户的损害。

To create a new account, use [`CREATE USER`](https://dev.mysql.com/doc/refman/8.0/en/create-user.html). To grant this account the privileges required for replication, use the [`GRANT`](https://dev.mysql.com/doc/refman/8.0/en/grant.html) statement. If you create an account solely for the purposes of replication, that account needs only the [`REPLICATION SLAVE`](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave) privilege. For example, to set up a new user, `repl`, that can connect for replication from any host within the `example.com` domain, issue these statements on the source:

要创建新帐户，请使用[' create USER '](https://dev.mysql.com/doc/refman/8.0/en/create-user.html)。要授予此帐户复制所需的权限，请使用[' grant '](https://dev.mysql.com/doc/refman/8.0/en/grant.html)语句。如果您仅为复制目的创建一个帐户，该帐户只需要[' replication SLAVE '](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave)权限。例如，要建立一个新用户' repl '，它可以从' example.com '域内的任何主机进行连接复制，在源程序上发出以下语句:

```sql
mysql> CREATE USER 'repl'@'%.example.com' IDENTIFIED BY 'password';
mysql> GRANT REPLICATION SLAVE ON *.* TO 'repl'@'%.example.com';
```

See [Section 13.7.1, “Account Management Statements”](https://dev.mysql.com/doc/refman/8.0/en/account-management-statements.html), for more information on statements for manipulation of user accounts.

>   Important
>
>   To connect to the source using a user account that authenticates with the `caching_sha2_password` plugin, you must either set up a secure connection as described in [Section 17.3.1, “Setting Up Replication to Use Encrypted Connections”](https://dev.mysql.com/doc/refman/8.0/en/replication-encrypted-connections.html), or enable the unencrypted connection to support password exchange using an RSA key pair. The `caching_sha2_password` authentication plugin is the default for new users created from MySQL 8.0 (for details, see [Section 6.4.1.2, “Caching SHA-2 Pluggable Authentication”](https://dev.mysql.com/doc/refman/8.0/en/caching-sha2-pluggable-authentication.html)). If the user account that you create or use for replication (as specified by the `MASTER_USER` option) uses this authentication plugin, and you are not using a secure connection, you must enable RSA key pair-based password exchange for a successful connection.



## 17.1.2.4 Obtaining the Replication Source Binary Log Coordinates

To configure the replica to start the replication process at the correct point, you need to note the source's current coordinates within its binary log.

要配置副本以在正确的点启动复制进程，需要在其二进制日志中记录源的当前坐标。

>   Warning
>
>   This procedure uses [`FLUSH TABLES WITH READ LOCK`](https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables-with-read-lock), which blocks [`COMMIT`](https://dev.mysql.com/doc/refman/8.0/en/commit.html) operations for [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html) tables.
>
>   这个过程使用[' FLUSH TABLES WITH READ LOCK '](https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables-with-read-lock)，它会阻塞[' InnoDB '](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html)表的[' COMMIT '](https://dev.mysql.com/doc/refman/8.0/en/commit.html)操作。

If you are planning to shut down the source to create a data snapshot, you can optionally skip this procedure and instead store a copy of the binary log index file along with the data snapshot. In that situation, the source creates a new binary log file on restart. The source binary log coordinates where the replica must start the replication process are therefore the start of that new file, which is the next binary log file on the source following after the files that are listed in the copied binary log index file.

如果计划关闭源以创建数据快照，则可以选择跳过此过程，而是将二进制日志索引文件的副本与数据快照一起存储。在这种情况下，源在重新启动时创建一个新的二进制日志文件。因此，复制必须在其中启动复制过程的源二进制日志坐标是该新文件的开始位置，该新文件是在复制的二进制日志索引文件中列出的文件之后的源上的下一个二进制日志文件。

To obtain the source binary log coordinates, follow these steps:

要获取源二进制日志坐标，请遵循以下步骤:

1.  Start a session on the source by connecting to it with the command-line client, and flush all tables and block write statements by executing the [`FLUSH TABLES WITH READ LOCK`](https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables-with-read-lock) statement:

    通过命令行客户端连接到源上启动一个会话，并通过执行[' flush tables with READ LOCK '](https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables-with-read-lock)语句刷新所有表和阻塞写语句:

    ```sql
    mysql> FLUSH TABLES WITH READ LOCK;
    ```

    >   Warning
    >
    >   Leave the client from which you issued the [`FLUSH TABLES`](https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables) statement running so that the read lock remains in effect. If you exit the client, the lock is released.
    >
    >   让发出[' FLUSH TABLES '](https://dev.mysql.com/doc/refman/8.0/en/flush.html#flush-tables)语句的客户端保持运行状态，以便读锁保持有效。如果退出客户端，则释放锁。
    >
    >   备注：启用这个，事务等语句都会阻塞（不会提示是因为这个原因，是因为阻塞，而不是不能做）

2.  In a different session on the source, use the [`SHOW MASTER STATUS`](https://dev.mysql.com/doc/refman/8.0/en/show-master-status.html) statement to determine the current binary log file name and position:

    在源上的另一个会话中，使用[' SHOW MASTER STATUS '](https://dev.mysql.com/doc/refman/8.0/en/show-master-status.html)语句确定当前二进制日志文件的名称和位置:

    ```sql
    mysql > SHOW MASTER STATUS;
    +------------------+----------+--------------+------------------+
    | File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |
    +------------------+----------+--------------+------------------+
    | mysql-bin.000003 | 73       | test         | manual,mysql     |
    +------------------+----------+--------------+------------------+
    ```

    The `File` column shows the name of the log file and the `Position` column shows the position within the file. In this example, the binary log file is `mysql-bin.000003` and the position is 73. Record these values. You need them later when you are setting up the replica. They represent the replication coordinates at which the replica should begin processing new updates from the source.

    “File”列显示日志文件的名称，“Position”列显示文件中的位置。在本例中，二进制日志文件为' mysql-bin.000003 '，位置是73。记录这些值。稍后在设置副本时需要它们。它们表示复制坐标，副本应该从这个坐标开始处理来自源的新更新。

    If the source has been running previously with binary logging disabled, the log file name and position values displayed by [`SHOW MASTER STATUS`](https://dev.mysql.com/doc/refman/8.0/en/show-master-status.html) or [**mysqldump --master-data**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) are empty. In that case, the values that you need to use later when specifying the source's binary log file and position are the empty string (`''`) and `4`.

    如果源之前已经在禁用二进制日志记录的情况下运行，则由[' SHOW MASTER STATUS '](https://dev.mysql.com/doc/refman/8.0/en/show-master-status.html)或[**mysqldump——MASTER -data**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html)显示的日志文件名和位置值为空。在这种情况下，稍后指定源的二进制日志文件和位置时需要使用的值是空字符串(" '')和' 4 '。

You now have the information you need to enable the replica to start reading from the source's binary log in the correct place to start replication.

现在，您已经拥有了在启动复制的正确位置开始从源二进制日志读取所需的信息。

The next step depends on whether you have existing data on the source. Choose one of the following options:

下一步取决于源上是否有现有数据。选择以下选项之一:

-   If you have existing data that needs be to synchronized with the replica before you start replication, leave the client running so that the lock remains in place. This prevents any further changes being made, so that the data copied to the replica is in synchrony with the source. Proceed to [Section 17.1.2.5, “Choosing a Method for Data Snapshots”](https://dev.mysql.com/doc/refman/8.0/en/replication-snapshot-method.html).

    如果在开始复制之前有需要与副本同步的现有数据，请保持客户端运行，以便锁保持在适当的位置。这防止了任何进一步的更改，以便复制到副本的数据与源同步。参见[第17.1.2.5节，“为数据快照选择方法”](https://dev.mysql.com/doc/refman/8.0/en/replication-snapshot-method.html)。

-   If you are setting up a new source and replica combination, you can exit the first session to release the read lock. See [Section 17.1.2.6.1, “Setting Up Replication with New Source and Replicas”](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html#replication-howto-newservers) for how to proceed.

    如果您正在设置一个新的源和副本组合，您可以退出第一个会话来释放读锁。参见[第17.1.2.6.1节，“使用新源和副本设置复制”](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html#replication-howto-newservers)了解如何继续。



## 17.1.2.5 Choosing a Method for Data Snapshots

If the source database contains existing data it is necessary to copy this data to each replica. There are different ways to dump the data from the source database. The following sections describe possible options.

如果源数据库包含现有数据，则需要将该数据复制到每个副本。从源数据库中转储数据有不同的方法。以下部分描述了可能的选项。

To select the appropriate method of dumping the database, choose between these options:

要选择适当的转储数据库的方法，请在以下选项中进行选择:

-   Use the [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) tool to create a dump of all the databases you want to replicate. This is the recommended method, especially when using [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html).

    使用[**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html)工具创建要复制的所有数据库的转储。这是推荐的方法，特别是在使用[' InnoDB '](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html)时。

-   If your database is stored in binary portable files, you can copy the raw data files to a replica. This can be more efficient than using [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) and importing the file on each replica, because it skips the overhead of updating indexes as the `INSERT` statements are replayed. With storage engines such as [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html) this is not recommended.

    如果数据库存储在二进制可移植文件中，则可以将原始数据文件复制到副本中。这比使用[**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html)在每个副本上导入文件更有效，因为它跳过了在重复播放' INSERT '语句时更新索引的开销。对于[' InnoDB '](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html)这样的存储引擎，不建议这样做。

-   Use MySQL Server's clone plugin to transfer all the data from an existing replica to a clone. For instructions to use this method, see [Section 5.6.7.7, “Cloning for Replication”](https://dev.mysql.com/doc/refman/8.0/en/clone-plugin-replication.html).

    使用MySQL服务器的克隆插件将所有数据从一个现有的副本转移到一个克隆。有关使用这种方法的说明，请参见[第5.6.7.7节，“克隆复制”](https://dev.mysql.com/doc/refman/8.0/en/clone-plugin-replication.html)。

>   Tip
>
>   To deploy multiple instances of MySQL, you can use [InnoDB Cluster](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-innodb-cluster.html) which enables you to easily administer a group of MySQL server instances in [MySQL Shell](https://dev.mysql.com/doc/mysql-shell/8.0/en/). InnoDB Cluster wraps MySQL Group Replication in a programmatic environment that enables you easily deploy a cluster of MySQL instances to achieve high availability. In addition, InnoDB Cluster interfaces seamlessly with [MySQL Router](https://dev.mysql.com/doc/mysql-router/8.0/en/), which enables your applications to connect to the cluster without writing your own failover process. For similar use cases that do not require high availability, however, you can use [InnoDB ReplicaSet](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-innodb-replicaset.html). Installation instructions for MySQL Shell can be found [here](https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-install.html).

### 17.1.2.5.1 Creating a Data Snapshot Using mysqldump

To create a snapshot of the data in an existing source database, use the [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) tool. Once the data dump has been completed, import this data into the replica before starting the replication process.

要创建现有源数据库中的数据快照，请使用[**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html)工具。完成数据转储之后，在开始复制过程之前，将该数据导入到副本中。

The following example dumps all databases to a file named `dbdump.db`, and includes the [`--master-data`](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_master-data) option which automatically appends the [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement required on the replica to start the replication process:

下面的示例将所有数据库转储到一个名为`dbdump.db` 的文件中，并包含['——MASTER -data '](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_master-data)选项，该选项自动附加副本上启动复制过程所需的[' CHANGE REPLICATION SOURCE to '](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | [' CHANGE MASTER to '](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html)语句:

```terminal
$> mysqldump --all-databases --master-data > dbdump.db
```

>   Note
>
>   If you do not use [`--master-data`](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_master-data), then it is necessary to lock all tables in a separate session manually. See [Section 17.1.2.4, “Obtaining the Replication Source Binary Log Coordinates”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html).
>
>   如果不使用['——master-data '](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_master-data)，则需要手动锁定单独会话中的所有表。参见[第17.1.2.4节“获取复制源二进制日志坐标”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html)。

It is possible to exclude certain databases from the dump using the [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) tool. If you want to choose which databases to include in the dump, do not use [`--all-databases`](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_all-databases). Choose one of these options:

可以使用[**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html)工具从转储中排除某些数据库。如果希望选择转储中包含哪些数据库，请不要使用['——all-databases '](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_all-databases)。选择以下选项之一:

-   Exclude all the tables in the database using [`--ignore-table`](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_ignore-table) option.

    使用['——ignore-table '](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_ignore-table)选项排除数据库中的所有表。

-   Name only those databases which you want dumped using the [`--databases`](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_databases) option.

    使用['——databases '](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html#option_mysqldump_databases)选项只指定您希望转储的数据库的名称。

>   Note
>
>   By default, if GTIDs are in use on the source ([`gtid_mode=ON`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html#sysvar_gtid_mode)), [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) includes the GTIDs from the [`gtid_executed`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html#sysvar_gtid_executed) set on the source in the dump output to add them to the [`gtid_purged`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html#sysvar_gtid_purged) set on the replica. If you are dumping only specific databases or tables, it is important to note that the value that is included by [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html) includes the GTIDs of all transactions in the [`gtid_executed`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html#sysvar_gtid_executed) set on the source, even those that changed suppressed parts of the database, or other databases on the server that were not included in the partial dump. Check the description for mysqldump's `--set-gtid-purged` option to find the outcome of the default behavior for the MySQL Server versions you are using, and how to change the behavior if this outcome is not suitable for your situation.

For more information, see [Section 4.5.4, “mysqldump — A Database Backup Program”](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html).

To import the data, either copy the dump file to the replica, or access the file from the source when connecting remotely to the replica.

若要导入数据，请将转储文件复制到副本，或在远程连接到副本时从源访问该文件。



### 17.1.2.5.2 Creating a Data Snapshot Using Raw Data Files

This section describes how to create a data snapshot using the raw files which make up the database. Employing this method with a table using a storage engine that has complex caching or logging algorithms requires extra steps to produce a perfect “point in time” snapshot: the initial copy command could leave out cache information and logging updates, even if you have acquired a global read lock. How the storage engine responds to this depends on its crash recovery abilities.

本节介绍如何使用组成数据库的原始文件创建数据快照。在使用具有复杂缓存或日志算法的存储引擎的表中使用此方法需要额外的步骤来生成完美的“时间点”快照:初始复制命令可能会遗漏缓存信息和日志更新，即使您已经获得了全局读锁。存储引擎如何对此作出响应取决于它的崩溃恢复能力。

If you use [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html) tables, you can use the **mysqlbackup** command from the MySQL Enterprise Backup component to produce a consistent snapshot. This command records the log name and offset corresponding to the snapshot to be used on the replica. MySQL Enterprise Backup is a commercial product that is included as part of a MySQL Enterprise subscription. See [Section 30.2, “MySQL Enterprise Backup Overview”](https://dev.mysql.com/doc/refman/8.0/en/mysql-enterprise-backup.html) for detailed information.

如果使用InnoDB表，可以使用MySQL Enterprise Backup组件中的mysqlbackup命令生成一致的快照。此命令记录要用于副本的快照对应的日志名称和偏移量。MySQL企业备份是一个商业产品，包含在MySQL企业订阅中。详细信息请参见第30.2节“MySQL企业备份概述”。

This method also does not work reliably if the source and replica have different values for [`ft_stopword_file`](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_ft_stopword_file), [`ft_min_word_len`](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_ft_min_word_len), or [`ft_max_word_len`](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_ft_max_word_len) and you are copying tables having full-text indexes.

如果源和副本对ft_stopword_file、ft_min_word_len或ft_max_word_len有不同的值，并且您正在复制具有全文索引的表，则此方法也不可靠。

Assuming the above exceptions do not apply to your database, use the [cold backup](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_cold_backup) technique to obtain a reliable binary snapshot of `InnoDB` tables: do a [slow shutdown](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_slow_shutdown) of the MySQL Server, then copy the data files manually.

假设以上的例外情况不适用于你的数据库，使用冷备份技术来获得一个可靠的InnoDB表的二进制快照：慢速关闭MySQL服务器，然后手动复制数据文件。

To create a raw data snapshot of [`MyISAM`](https://dev.mysql.com/doc/refman/8.0/en/myisam-storage-engine.html) tables when your MySQL data files exist on a single file system, you can use standard file copy tools such as **cp** or **copy**, a remote copy tool such as **scp** or **rsync**, an archiving tool such as **zip** or **tar**, or a file system snapshot tool such as **dump**. If you are replicating only certain databases, copy only those files that relate to those tables. For `InnoDB`, all tables in all databases are stored in the [system tablespace](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_system_tablespace) files, unless you have the [`innodb_file_per_table`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_file_per_table) option enabled.

当MySQL数据文件存在于单个文件系统中时，要创建MyISAM表的原始数据快照，可以使用标准的文件复制工具(如cp或copy)、远程复制工具(如scp或rsync)、归档工具(如zip或tar)或文件系统快照工具(如dump)。如果只复制某些数据库，则只复制与这些表相关的文件。对于InnoDB，所有数据库中的所有表都存储在系统表空间文件中，除非你启用了innodb_file_per_table选项。

The following files are not required for replication:

复制时不需要以下文件:

-   Files relating to the `mysql` database.

    与mysql数据库相关的文件。

-   The replica's connection metadata repository file `master.info`, if used; the use of this file is now deprecated (see [Section 17.2.4, “Relay Log and Replication Metadata Repositories”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs.html)).

    副本的连接元数据存储库文件master.info，如果使用;此文件的使用现在已弃用(参见第17.2.4节“中继日志和复制元数据存储库”)。

-   The source's binary log files, with the exception of the binary log index file if you are going to use this to locate the source binary log coordinates for the replica.

    源的二进制日志文件，除了二进制日志索引文件(如果您要使用它来定位副本的源二进制日志坐标)。

-   Any relay log files.

    任何延迟日志文件。

Depending on whether you are using `InnoDB` tables or not, choose one of the following:

根据你是否使用InnoDB表，选择以下之一:

If you are using [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html) tables, and also to get the most consistent results with a raw data snapshot, shut down the source server during the process, as follows:

如果你正在使用InnoDB表，并且也想通过原始数据快照获得最一致的结果，在这个过程中关闭源服务器，如下所示:

1.  Acquire a read lock and get the source's status. See [Section 17.1.2.4, “Obtaining the Replication Source Binary Log Coordinates”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html).

    获取读锁并获取源的状态。

2.  In a separate session, shut down the source server:

    在单独的会话中，关闭源服务器

    ```terminal
    $> mysqladmin shutdown
    ```

3.  Make a copy of the MySQL data files. The following examples show common ways to do this. You need to choose only one of them:

    复制MySQL数据文件。下面的例子展示了实现这一点的常用方法。你只需要选择其中一个:

    ```terminal
    $> tar cf /tmp/db.tar ./data
    $> zip -r /tmp/db.zip ./data
    $> rsync --recursive ./data /tmp/dbdata
    ```

4.  Restart the source server.

    重启源服务器

If you are not using [`InnoDB`](https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html) tables, you can get a snapshot of the system from a source without shutting down the server as described in the following steps:

如果你不使用InnoDB表，你可以在不关闭服务器的情况下从源获取系统快照，步骤如下:

1.  Acquire a read lock and get the source's status. See [Section 17.1.2.4, “Obtaining the Replication Source Binary Log Coordinates”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html).

    获取读锁并获取源的状态。

2.  Make a copy of the MySQL data files. The following examples show common ways to do this. You need to choose only one of them:

    复制MySQL数据文件。下面的例子展示了实现这一点的常用方法。你只需要选择其中一个:

    ```terminal
    $> tar cf /tmp/db.tar ./data
    $> zip -r /tmp/db.zip ./data
    $> rsync --recursive ./data /tmp/dbdata
    ```

3.  In the client where you acquired the read lock, release the lock:

    在获取读锁的客户端中，释放锁:

    ```sql
    mysql> UNLOCK TABLES;
    ```

Once you have created the archive or copy of the database, copy the files to each replica before starting the replication process.

一旦创建了数据库的存档或副本，在开始复制过程之前，将文件复制到每个副本。



## 17.1.2.6 Setting Up Replicas

The following sections describe how to set up replicas. Before you proceed, ensure that you have:

以下部分描述如何设置副本。在你继续之前，确保你已经:

-   Configured the source with the necessary configuration properties. See [Section 17.1.2.1, “Setting the Replication Source Configuration”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterbaseconfig.html).

    为源配置了必要的配置属性。

-   Obtained the source status information, or a copy of the source's binary log index file made during a shutdown for the data snapshot. See [Section 17.1.2.4, “Obtaining the Replication Source Binary Log Coordinates”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-masterstatus.html).

    已获取源状态信息，或在为数据快照关闭期间生成的源二进制日志索引文件的副本。

-   On the source, released the read lock:

    在源上，释放读锁：

    ```sql
    mysql> UNLOCK TABLES;
    ```

-   On the replica, edited the MySQL configuration. See [Section 17.1.2.2, “Setting the Replica Configuration”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slavebaseconfig.html).

    在副本上，编辑MySQL配置。

The next steps depend on whether you have existing data to import to the replica or not. See [Section 17.1.2.5, “Choosing a Method for Data Snapshots”](https://dev.mysql.com/doc/refman/8.0/en/replication-snapshot-method.html) for more information. Choose one of the following:

接下来的步骤取决于是否有要导入到副本的现有数据。更多信息请参见17.1.2.5节“为数据快照选择方法”。选择下列其中一项:

-   If you do not have a snapshot of a database to import, see [Section 17.1.2.6.1, “Setting Up Replication with New Source and Replicas”](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html#replication-howto-newservers).

    如果没有要导入的数据库快照，

-   If you have a snapshot of a database to import, see [Section 17.1.2.6.2, “Setting Up Replication with Existing Data”](https://dev.mysql.com/doc/refman/8.0/en/replication-setup-replicas.html#replication-howto-existingdata).

    如果要导入数据库的快照，

### 17.1.2.6.1 Setting Up Replication with New Source and Replicas

When there is no snapshot of a previous database to import, configure the replica to start replication from the new source.

如果没有要导入的前一个数据库的快照，则配置副本从新的源启动复制。

To set up replication between a source and a new replica:

在一个源和一个新的副本之间建立复制：

1.  Start up the replica.

    启动副本

2.  Execute a [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement on the replica to set the source configuration. See [Section 17.1.2.7, “Setting the Source Configuration on the Replica”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slaveinit.html).

    在副本上执行CHANGE REPLICATION SOURCE TO | CHANGE MASTER TO语句来设置源配置。参见17.1.2.7节“在副本上设置源配置”。

Perform these replica setup steps on each replica.

在每个副本上执行这些副本设置步骤。

This method can also be used if you are setting up new servers but have an existing dump of the databases from a different server that you want to load into your replication configuration. By loading the data into a new source, the data is automatically replicated to the replicas.

如果您正在设置新的服务器，但有来自不同服务器的数据库的现有转储，希望将其加载到复制配置中，那么也可以使用此方法。通过将数据加载到新的源中，数据将自动复制到副本中。

If you are setting up a new replication environment using the data from a different existing database server to create a new source, run the dump file generated from that server on the new source. The database updates are automatically propagated to the replicas:

如果您正在使用来自另一个现有数据库服务器的数据设置新的复制环境以创建新的源，那么在新源上运行从该服务器生成的转储文件。数据库更新会自动传播到副本:

```terminal
$> mysql -h source < fulldb.dump
```



### 17.1.2.6.2 Setting Up Replication with Existing Data

When setting up replication with existing data, transfer the snapshot from the source to the replica before starting replication. The process for importing data to the replica depends on how you created the snapshot of data on the source.

在使用现有数据建立复制时，请在开始复制之前将快照从源端转移到副本。将数据导入副本的过程取决于在源上创建数据快照的方式。

As an alternative to creating a new replica in this way, MySQL Server's clone plugin can be used to transfer all the data and replication settings from an existing replica to a clone. For instructions to use this method, see [Section 5.6.7.7, “Cloning for Replication”](https://dev.mysql.com/doc/refman/8.0/en/clone-plugin-replication.html).

作为一种创建新副本的替代方法，MySQL Server的克隆插件可以用来将所有数据和复制设置从现有副本转移到克隆。关于使用这种方法的说明，请参见第5.6.7.7节“克隆复制”。

Follow this procedure to set up replication with existing data:

按照以下步骤使用现有数据建立复制:

1.  If you used MySQL Server's clone plugin to create a clone from an existing replica (see [Section 5.6.7.7, “Cloning for Replication”](https://dev.mysql.com/doc/refman/8.0/en/clone-plugin-replication.html)), the data is already transferred. Otherwise, import the data to the replica using one of the following methods.

    如果您使用MySQL Server的克隆插件从现有的副本创建一个克隆(参见第5.6.7.7节“克隆复制”)，数据已经被传输。否则，请使用以下方法之一将数据导入副本。

    1.  If you used [**mysqldump**](https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html), start the replica server, ensuring that replication does not start by using the [`--skip-slave-start`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#option_mysqld_skip-slave-start) option, or from MySQL 8.0.24, the [`skip_slave_start`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_skip_slave_start) system variable. Then import the dump file:

        如果使用mysqldump，则启动复制服务器，确保复制不会通过使用——skip-slave-start选项或从MySQL 8.0.24的skip_slave_start系统变量启动。然后导入转储文件:

        ```terminal
        $> mysql < fulldb.dump
        ```

    2.  If you created a snapshot using the raw data files, extract the data files into your replica's data directory. For example:

        如果使用原始数据文件创建快照，请将数据文件解压缩到副本的数据目录中。例如:

        ```terminal
        $> tar xvf dbdump.tar
        ```

        You may need to set permissions and ownership on the files so that the replica server can access and modify them. Then start the replica server, ensuring that replication does not start by using the [`--skip-slave-start`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#option_mysqld_skip-slave-start) option, or from MySQL 8.0.24, the [`skip_slave_start`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_skip_slave_start) system variable.

        您可能需要设置文件的权限和所有权，以便复制服务器能够访问和修改它们。然后启动复制服务器，确保复制不会通过使用['——skip-slave-start '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#option_mysqld_skip-slave-start)选项或从MySQL 8.0.24中使用[' skip_slave_start '](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_skip_slave_start)系统变量来启动。

2.  Configure the replica with the replication coordinates from the source. This tells the replica the binary log file and position within the file where replication needs to start. Also, configure the replica with the login credentials and host name of the source. For more information on the [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement required, see [Section 17.1.2.7, “Setting the Source Configuration on the Replica”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slaveinit.html).

    使用来自源的复制坐标配置副本。这将告诉副本二进制日志文件以及需要在文件中开始复制的位置。另外，使用源的登录凭据和主机名配置副本。有关CHANGE REPLICATION SOURCE TO | CHANGE MASTER TO语句的更多信息，请参见17.1.2.7“在副本上设置源配置”。

3.  Start the replication threads by issuing a [`START REPLICA`](https://dev.mysql.com/doc/refman/8.0/en/start-replica.html) (or before MySQL 8.0.22, [`START SLAVE`](https://dev.mysql.com/doc/refman/8.0/en/start-replica.html)) statement.

    通过发出Start REPLICA(或MySQL 8.0.22之前的Start SLAVE)语句启动复制线程。

After you have performed this procedure, the replica connects to the source and replicates any updates that have occurred on the source since the snapshot was taken. Error messages are issued to the replica's error log if it is not able to replicate for any reason.

执行此过程后，副本将连接到源，并复制自创建快照以来源上发生的所有更新。如果由于任何原因无法复制，则会向副本的错误日志发出错误消息。

The replica uses information logged in its connection metadata repository and applier metadata repository to keep track of how much of the source's binary log it has processed. From MySQL 8.0, by default, these repositories are tables named `slave_master_info` and `slave_relay_log_info` in the `mysql` database. Do *not* remove or edit these tables unless you know exactly what you are doing and fully understand the implications. Even in that case, it is preferred that you use the [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement to change replication parameters. The replica uses the values specified in the statement to update the replication metadata repositories automatically. See [Section 17.2.4, “Relay Log and Replication Metadata Repositories”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs.html), for more information.

副本使用其连接元数据存储库和应用程序元数据存储库中记录的信息来跟踪它处理了多少源的二进制日志。从MySQL 8.0开始，默认情况下，这些存储库是MySQL数据库中名为slave_master_info和slave_relay_log_info的表。不要删除或编辑这些表，除非您确切地知道自己在做什么，并完全理解其含义。即使在这种情况下，也最好使用CHANGE REPLICATION SOURCE TO | CHANGE MASTER TO语句来更改复制参数。副本使用语句中指定的值自动更新复制元数据存储库。更多信息请参见17.2.4节“中继日志和复制元数据存储库”。

>   Note
>
>   The contents of the replica's connection metadata repository override some of the server options specified on the command line or in `my.cnf`. See [Section 17.1.6, “Replication and Binary Logging Options and Variables”](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html), for more details.

A single snapshot of the source suffices for multiple replicas. To set up additional replicas, use the same source snapshot and follow the replica portion of the procedure just described.

源的一个快照足以满足多个副本。要设置其他副本，请使用相同的源快照并遵循刚才描述的过程中的副本部分。



## 17.1.2.7 Setting the Source Configuration on the Replica

To set up the replica to communicate with the source for replication, configure the replica with the necessary connection information. To do this, on the replica, execute the [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) statement (from MySQL 8.0.23) or [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement (before MySQL 8.0.23), replacing the option values with the actual values relevant to your system:

若要设置副本以与复制源通信，请使用必要的连接信息配置副本。要做到这一点，在副本上，执行CHANGE REPLICATION SOURCE To语句(从MySQL 8.0.23)或CHANGE MASTER To语句(在MySQL 8.0.23之前)，用与您的系统相关的实际值替换选项值:

```sql
mysql> CHANGE MASTER TO
    ->     MASTER_HOST='source_host_name',
    ->     MASTER_USER='replication_user_name',
    ->     MASTER_PASSWORD='replication_password',
    ->     MASTER_LOG_FILE='recorded_log_file_name',
    ->     MASTER_LOG_POS=recorded_log_position;

Or from MySQL 8.0.23:
mysql> CHANGE REPLICATION SOURCE TO
    ->     SOURCE_HOST='source_host_name',
    ->     SOURCE_USER='replication_user_name',
    ->     SOURCE_PASSWORD='replication_password',
    ->     SOURCE_LOG_FILE='recorded_log_file_name',
    ->     SOURCE_LOG_POS=recorded_log_position;
```

>   Note
>
>   Replication cannot use Unix socket files. You must be able to connect to the source MySQL server using TCP/IP.

The [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | [`CHANGE MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html) statement has other options as well. For example, it is possible to set up secure replication using SSL. For a full list of options, and information about the maximum permissible length for the string-valued options, see [Section 13.4.2.1, “CHANGE MASTER TO Statement”](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html).

CHANGE REPLICATION SOURCE TO | CHANGE MASTER TO语句还有其他选项。例如，可以使用SSL设置安全复制。有关选项的完整列表以及字符串值选项允许的最大长度的信息，请参见13.4.2.1节“CHANGE MASTER TO语句”。

>   Important
>
>   As noted in [Section 17.1.2.3, “Creating a User for Replication”](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-repuser.html), if you are not using a secure connection and the user account named in the `SOURCE_USER` | `MASTER_USER` option authenticates with the `caching_sha2_password` plugin (the default from MySQL 8.0), you must specify the `SOURCE_PUBLIC_KEY_PATH` | `MASTER_PUBLIC_KEY_PATH` or `GET_SOURCE_PUBLIC_KEY` | `GET_MASTER_PUBLIC_KEY` option in the [`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html) | `CHANGE MASTER TO` statement to enable RSA key pair-based password exchange.





## 17.1.2.8 Adding Replicas to a Replication Environment

You can add another replica to an existing replication configuration without stopping the source server. To do this, you can set up the new replica by copying the data directory of an existing replica, and giving the new replica a different server ID (which is user-specified) and server UUID (which is generated at startup).

您可以在不停止源服务器的情况下向现有复制配置添加另一个副本。为此，您可以通过复制现有副本的数据目录，并为新副本提供不同的服务器ID(这是用户指定的)和服务器UUID(这是在启动时生成的)来设置新的副本。

>   Note
>
>   If the replication source server or existing replica that you are copying to create the new replica has any scheduled events, ensure that these are disabled on the new replica before you start it. If an event runs on the new replica that has already run on the source, the duplicated operation causes an error. The Event Scheduler is controlled by the [`event_scheduler`](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_event_scheduler) system variable, which defaults to `ON` from MySQL 8.0, so events that are active on the original server run by default when the new replica starts up. To stop all events from running on the new replica, set the [`event_scheduler`](https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_event_scheduler) system variable to `OFF` or `DISABLED` on the new replica. Alternatively, you can use the [`ALTER EVENT`](https://dev.mysql.com/doc/refman/8.0/en/alter-event.html) statement to set individual events to `DISABLE` or `DISABLE ON SLAVE` to prevent them from running on the new replica. You can list the events on a server using the [`SHOW`](https://dev.mysql.com/doc/refman/8.0/en/show.html) statement or the Information Schema [`EVENTS`](https://dev.mysql.com/doc/refman/8.0/en/information-schema-events-table.html) table. For more information, see [Section 17.5.1.16, “Replication of Invoked Features”](https://dev.mysql.com/doc/refman/8.0/en/replication-features-invoked.html).
>
>   复制的时候不要启用事件。

As an alternative to creating a new replica in this way, MySQL Server's clone plugin can be used to transfer all the data and replication settings from an existing replica to a clone. For instructions to use this method, see [Section 5.6.7.7, “Cloning for Replication”](https://dev.mysql.com/doc/refman/8.0/en/clone-plugin-replication.html).

作为一种创建新副本的替代方法，MySQL Server的克隆插件可以用来将所有数据和复制设置从现有副本转移到克隆。关于使用这种方法的说明，请参见第5.6.7.7节“克隆复制”。

To duplicate an existing replica without cloning, follow these steps:

要复制一个现有副本而不进行克隆，请执行以下步骤:

1.  Stop the existing replica and record the replica status information, particularly the source binary log file and relay log file positions. You can view the replica status either in the Performance Schema replication tables (see [Section 27.12.11, “Performance Schema Replication Tables”](https://dev.mysql.com/doc/refman/8.0/en/performance-schema-replication-tables.html)), or by issuing [`SHOW REPLICA STATUS`](https://dev.mysql.com/doc/refman/8.0/en/show-replica-status.html) as follows:

    停止现有的副本并记录副本状态信息，特别是源二进制日志文件和中继日志文件的位置。您可以在性能模式复制表(参见第27.12.11节“性能模式复制表”)中查看副本状态，也可以发出SHOW replica status命令，如下所示:

    ```sql
    mysql> STOP SLAVE;
    mysql> SHOW SLAVE STATUS\G
    Or from MySQL 8.0.22:
    mysql> STOP REPLICA;
    mysql> SHOW REPLICA STATUS\G
    ```

2.  Shut down the existing replica:

    关闭现有副本:

    ```terminal
    $> mysqladmin shutdown
    ```

3.  Copy the data directory from the existing replica to the new replica, including the log files and relay log files. You can do this by creating an archive using **tar** or `WinZip`, or by performing a direct copy using a tool such as **cp** or **rsync**.

    将数据目录从现有副本复制到新副本，包括日志文件和中继日志文件。您可以通过使用**tar**或' WinZip '创建存档，或使用**cp**或**rsync**等工具执行直接复制来实现这一点。

>   Important
>
>   -   Before copying, verify that all the files relating to the existing replica actually are stored in the data directory. For example, the `InnoDB` system tablespace, undo tablespace, and redo log might be stored in an alternative location. `InnoDB` tablespace files and file-per-table tablespaces might have been created in other directories. The binary logs and relay logs for the replica might be in their own directories outside the data directory. Check through the system variables that are set for the existing replica and look for any alternative paths that have been specified. If you find any, copy these directories over as well.
>
>       在复制之前，请验证与现有副本相关的所有文件实际上都存储在data目录中。例如，InnoDB系统表空间、撤消表空间和重做日志可能存储在另一个位置。InnoDB表空间文件和每表一个文件的表空间可能已经在其他目录中创建。副本的二进制日志和中继日志可能位于数据目录之外的它们自己的目录中。检查为现有副本设置的系统变量，查找已指定的任何替代路径。如果找到了，也复制这些目录。
>
>   -   During copying, if files have been used for the replication metadata repositories (see [Section 17.2.4, “Relay Log and Replication Metadata Repositories”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs.html)), ensure that you also copy these files from the existing replica to the new replica. If tables have been used for the repositories, which is the default from MySQL 8.0, the tables are in the data directory.
>
>       在复制过程中，如果复制元数据存储库已经使用了文件(参见第17.2.4节“中继日志和复制元数据存储库”)，请确保还将这些文件从现有副本复制到新副本。如果存储库使用了表(这是MySQL 8.0的默认设置)，则表位于data目录中。
>
>   -   After copying, delete the `auto.cnf` file from the copy of the data directory on the new replica, so that the new replica is started with a different generated server UUID. The server UUID must be unique.
>
>       复制之后，从新副本上的数据目录的副本中删除auto.cnf文件，以便新副本以不同的生成的服务器UUID启动。服务器UUID不能重复。

A common problem that is encountered when adding new replicas is that the new replica fails with a series of warning and error messages like these:

添加新副本时遇到的一个常见问题是，新副本失败，并出现如下一系列警告和错误消息:

```none
071118 16:44:10 [Warning] Neither --relay-log nor --relay-log-index were used; so
replication may break when this MySQL server acts as a replica and has his hostname
changed!! Please use '--relay-log=new_replica_hostname-relay-bin' to avoid this problem.
071118 16:44:10 [ERROR] Failed to open the relay log './old_replica_hostname-relay-bin.003525'
(relay_log_pos 22940879)
071118 16:44:10 [ERROR] Could not find target log during relay log initialization
071118 16:44:10 [ERROR] Failed to initialize the master info structure
```

This situation can occur if the [`relay_log`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_relay_log) system variable is not specified, as the relay log files contain the host name as part of their file names. This is also true of the relay log index file if the [`relay_log_index`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_relay_log_index) system variable is not used. For more information about these variables, see [Section 17.1.6, “Replication and Binary Logging Options and Variables”](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html).

如果没有指定relay_log系统变量，就会出现这种情况，因为中继日志文件在文件名中包含主机名。如果不使用relay_log_index系统变量，中继日志索引文件也是如此。有关这些变量的更多信息，请参见17.1.6节“复制和二进制日志选项和变量”。

To avoid this problem, use the same value for [`relay_log`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_relay_log) on the new replica that was used on the existing replica. If this option was not set explicitly on the existing replica, use `*`existing_replica_hostname-relay-bin. If this is not possible, copy the existing replica's relay log index file to the new replica and set the [`relay_log_index`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_relay_log_index) system variable on the new replica to match what was used on the existing replica. If this option was not set explicitly on the existing replica, use `*`existing_replica_hostname`*-relay-bin.index`. Alternatively, if you have already tried to start the new replica after following the remaining steps in this section and have encountered errors like those described previously, then perform the following steps:

为了避免这个问题，在新的副本上为relay_log使用与现有副本上相同的值。如果没有在现有副本上显式设置此选项，请使用existing_replica_hostname-relay-bin。如果不可能，则将现有副本的中继日志索引文件复制到新副本，并在新副本上设置relay_log_index系统变量，以匹配现有副本上使用的变量。如果没有在现有副本上显式设置此选项，请使用existing_replica_hostname-relay-bin.index。或者，如果您在完成本节其余步骤之后已经尝试启动新的副本，并且遇到了类似于前面描述的错误，那么执行以下步骤:

1.  If you have not already done so, issue [`STOP REPLICA`](https://dev.mysql.com/doc/refman/8.0/en/stop-replica.html) on the new replica.

    If you have already started the existing replica again, issue [`STOP REPLICA`](https://dev.mysql.com/doc/refman/8.0/en/stop-replica.html) on the existing replica as well.

2.  Copy the contents of the existing replica's relay log index file into the new replica's relay log index file, making sure to overwrite any content already in the file.

3.  Proceed with the remaining steps in this section.



4.   When copying is complete, restart the existing replica.

     复制完成后，重新启动现有副本。

5.   On the new replica, edit the configuration and give the new replica a unique server ID (using the [`server_id`](https://dev.mysql.com/doc/refman/8.0/en/replication-options.html#sysvar_server_id) system variable) that is not used by the source or any of the existing replicas.

     在新的副本上，编辑配置并为新副本提供一个惟一的服务器ID(使用server_id系统变量)，该ID不被源或任何现有副本使用。

6.   Start the new replica server, ensuring that replication does not start yet by specifying the [`--skip-slave-start`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#option_mysqld_skip-slave-start) option, or from MySQL 8.0.24, the [`skip_slave_start`](https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html#sysvar_skip_slave_start) system variable. Use the Performance Schema replication tables or issue [`SHOW REPLICA STATUS`](https://dev.mysql.com/doc/refman/8.0/en/show-replica-status.html) to confirm that the new replica has the correct settings when compared with the existing replica. Also display the server ID and server UUID and verify that these are correct and unique for the new replica.

     通过指定——skip-slave-start选项，或从MySQL 8.0.24中指定skip_slave_start系统变量，启动新的复制服务器，确保复制尚未启动。使用性能模式复制表或发出SHOW REPLICA STATUS命令来确认新副本与现有副本相比具有正确的设置。还要显示服务器ID和服务器UUID，并验证它们对于新副本是正确的和惟一的。

7.   Start the replica threads by issuing a [`START REPLICA`](https://dev.mysql.com/doc/refman/8.0/en/start-replica.html) statement. The new replica now uses the information in its connection metadata repository to start the replication process.

     通过发出[' Start replica '](https://dev.mysql.com/doc/refman/8.0/en/start-replica.html)语句启动复制线程。新的副本现在使用其连接元数据存储库中的信息来启动复制过程。